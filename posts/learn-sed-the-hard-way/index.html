<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sed 小知识</title>
<meta name="keywords" content="珊瑚礁上的程序员, sed" />
<meta name="generator" content="Org Mode" />
<link rel="icon" href="https://demokn.github.io/blog/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://demokn.github.io/blog/assets/lib/twitter-bootstrap/4.4.1/bootstrap.min.css">
<link rel="stylesheet" href="https://demokn.github.io/blog/assets/lib/font-awesome/5.12.1/all.min.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=ZCOOL+KuaiLe|Amaranth|Handlee|Libre+Baskerville|Bree+Serif|Ubuntu+Mono|Pacifico&subset=latin,greek"/>
<link rel="stylesheet" href="https://demokn.github.io/blog/assets/css/site.css">
<link rel="stylesheet" href="https://demokn.github.io/blog/assets/css/highlight.css">
</head>
<body>
<div class="content-wrapper container">
<div class="row">
<div class="col-lg-8 col-md-10 mx-auto">

<div id="preamble" class="status">
<div class="banner">
  <a href="/" style="font-family: 'ZCOOL KuaiLe', cursive;"> 珊瑚礁上的程序员 </a>
</div>
<ul class="banner-links">
  <li><a href="https://demokn.github.io/blog/posts/archive.html"> Archive </a></li>
  <li><a href="https://demokn.github.io/blog/posts/rss.xml"> RSS </a></li>
  <li><a href="https://demokn.github.io/blog/about.html"> About </a></li>
</ul>
<hr>
</div>
<div id="article" class="content">
<header>
<h1 class="title">sed 小知识</h1>
<p class="subtitle" role="doc-subtitle">发布于 2024-01-06</p>
</header>
<section id="outline-container-org7c2d4a8" class="outline-2">
<h2 id="org7c2d4a8">正则表达式中的 <code>BRE</code> <code>ERE</code> 和 <code>PCRE</code></h2>
<div class="outline-text-2" id="text-org7c2d4a8">
<p>
<code>BRE（Basic Regular Expression）</code>
<code>ERE（Extended Regular Expression）</code> 和
<code>PCRE（Perl Compatible Regular Expression）</code>
是不同的正则表达式语法规范，它们在功能和语法上有所不同。
</p>

<p>
在 <code>GNU sed</code> 中默认使用的 <code>BRE</code>, 可以使用 <code>-E</code> 选项启用 <code>ERE</code>.
</p>

<p>
官方给出的描述是：在 <code>GNU sed</code> 中 <code>BRE</code> 和 <code>ERE</code> 的唯一区别是对一些特殊字符如 <code>?</code>, <code>+</code>, <code>()</code>, <code>{}</code>, 和 <code>|</code> 的处理不同。
在 <code>BRE</code> 中这些字符没有特殊的含义，除非他们被转义字符 <code>\</code> 转义。
而在 <code>ERE</code> 中是完全反过来的，这些特殊字符都是具有特殊含义的。
</p>

<blockquote>
<p>
Basic and extended regular expressions are two variations on the syntax of the specified pattern. Basic Regular Expression (BRE) syntax is the default in sed (and similarly in grep). Use the POSIX-specified -E option (-r, &#x2013;regexp-extended) to enable Extended Regular Expression (ERE) syntax.
</p>

<p>
In GNU sed, the only difference between basic and extended regular expressions is in the behavior of a few special characters: ‘?’, ‘+’, parentheses, braces (‘{}’), and ‘|’.
</p>

<p>
With basic (BRE) syntax, these characters do not have special meaning unless prefixed with a backslash (‘\’); While with extended (ERE) syntax it is reversed: these characters are special unless they are prefixed with backslash (‘\’).
</p>
</blockquote>

<p>
放几个相关链接
</p>

<ul class="org-ul">
<li><a href="https://www.gnu.org/software/sed/manual/html_node/BRE-vs-ERE.html#BRE-vs-ERE">GNU sed: BRE-vs-ERE</a></li>
<li><a href="https://www.baeldung.com/linux/bre-ere-pcre-syntax">Baeldung: The Differences Between BRE, ERE, and PCRE Syntax in Linux</a></li>
<li><a href="https://zerodayhacker.com/basic-or-extended-regex/">Basic or extended regex?</a></li>
<li><a href="https://learnbyexample.github.io/gnu-bre-ere-cheatsheet/">GNU BRE/ERE cheatsheet and differences between grep, sed and awk</a></li>
<li><a href="https://learnbyexample.github.io/learn_gnused/breere-regular-expressions.html">BRE/ERE Regular Expressions</a></li>
</ul>
</div>
</section>

<section id="outline-container-orge9d063b" class="outline-2">
<h2 id="orge9d063b">在匹配行的上一行插入代码并保持缩进</h2>
<div class="outline-text-2" id="text-orge9d063b">
<p>
源文件：
</p>
<pre class="example" id="orgc0f1883">
1
    2
3
</pre>

<p>
目的要在 <code>2</code> 这一行的上面一行插入 <code>666</code> 且要保持跟 <code>2</code> 这一行相同的缩进
</p>

<div class="org-src-container">
<pre class="src src-shell">sed -i <span class="org-string">'s/^\(\(.*\)2\)$/\2666\n\1/'</span> YOUR_FILE.txt
</pre>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<footer class="footer">
  <a href="https://github.com/demokn/blog">
    <p>
      Built with <img id="i-orgmode" src="https://demokn.github.io/blog/assets/images/orgmode.svg"/> in <img id="i-emacs" src="https://demokn.github.io/blog/assets/images/emacs.svg"/>
      <span id="view-source-link"> View Source </span>
    </p>
  </a>
</footer>
</div>
<div id="disqus_thread"></div>
<script>
  (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://coral-reef.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92899354-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-92899354-1');
</script>
<!-- Default Statcounter code -->
<script type="text/javascript">
var sc_project=11272126;
var sc_invisible=1;
var sc_security="cc0cb8d5";
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js"
async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img
class="statcounter"
src="https://c.statcounter.com/11272126/0/cc0cb8d5/1/"
alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
</body>
</html>
